<!DOCTYPE html>
<title>Polyfills and Shims</title>
<link rel="stylesheet" href="polyfill.css">

<h1>Polyfills and Shims (and more)</h1>

<ul>
  <li>A <em>shim</em> lets you write the same code across all browsers, e.g. by providing a new function with browser-specific implementations.
  <li>A <em>polyfill</em> is a shim or collection of shims that implements a new API in downlevel browsers.
</ul>

<p>In general, a polyfill is preferrable to a mere shim but may not be possible, practical, or efficient to implement. In practice, the terms get used somewhat interchangably.

<p>I use these in various pages on this site; most are by me, or I have at least tweaked them.
A more comprehensive list can be found at <a href="https://github.com/Modernizr/Modernizr/wiki/HTML5-Cross-browser-Polyfills">The All-In-One Entirely-Not-Alphabetical No-Bullshit Guide to HTML5 Fallbacks</a> by Paul Irish.

<ul>
  <li><a href="#polyfill">Browser Compat & ECMAScript 5</a>
  <li><a href="#harmony">ECMAScript "Harmony"</a>
  <li><a href="#url">URL</a>
  <li><a href="#keyboard">Keyboard Events</a>
  <li><a href="#timing">Timing control for script-based animations</a>
  <li><a href="#storage">Web Storage</a>
  <li><a href="#geo">Geolocation</a>
  <li><a href="#workers">Workers</a>
  <li><a href="#cookie">Cookies</a>
  <li><a href="#console">Console</a>
  <li><a href="#sprintf">sprintf</a>
  <li><a href="#typedarray">Typed Arrays</a>
</ul>


<h2 id="polyfill">Browser Compat &amp ECMAScript 5 (shims and polyfills)</h2>
<p>Bundled together; nearly every page I create needs at least some of these.
<p><a href="polyfill.js">script</a> - <a href="polyfill.html">unit tests</a>
<ul>
  <li><a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/dom.html#dom-document-head">HTML5 DOM Tree Accessors</a> (polyfill)
    <ul>
      <li><code>document.head</code></a>
    </ul>
  <li><a href="http://www.w3.org/TR/XMLHttpRequest/"><code>XMLHttpRequest</code></a> (polyfill for IE6-)
  <li><a href="https://dvcs.w3.org/hg/webperf/raw-file/tip/specs/setImmediate/Overview.html">Efficient Script Yielding</a> DRAFT (polyfill)
    <ul>
      <li><code><var>id</var> = setImmediate</code>
      <li><code>clearImmediate(<var>id</var>)</code>
    </ul>
  <li><a href="http://www.w3.org/TR/selectors-api/">Selector API</a> (polyfill for IE7-) - adapted from <a href="http://ajaxian.com/archives/creating-a-queryselector-for-ie-that-runs-at-native-speed">Paul Young</a>
    <ul>
      <li><code><var>element</var> = document.querySelector(<var>selector</var>)</code>
      <li><code><var>elementArray</var> = document.querySelectorAll(<var>selector</var>)</code>
      <li><code><var>elementArray</var> = document.getElementsByClassName(<var>class</var>)</code>
    </ul>
  <li><a href="http://www.w3.org/TR/DOM-Level-2-Events/">DOM Level 2 Events</a> (shim for IE8-) - adapted from <a href="http://www.quirksmode.org/blog/archives/2005/10/_and_the_winner_1.html">QuirksMode</a>
    <ul>
      <li><code>window.addEvent(<var>element</var>, <var>event</var>, <var>handler</var>)</code>
      <li><code>window.removeEvent(<var>element</var>, <var>event</var>, <var>handler</var>)</code>
    </ul>
  <li><a href="http://www.w3.org/TR/html5-author/webappapis.html#atob">Base64 Encoding</a> (polyfill for IE9-)
    <ul>
      <li><code><var>encodedString</var> = window.btoa(<var>binaryString</var>)</code>
      <li><code><var>binaryString</var> = window.atob(<var>encodedString</var>)</code>
    </ul>
  <li><a href="http://www.w3.org/TR/html5/common-dom-interfaces.html#domtokenlist">classList</a> (shim)
    <ul>
      <li><code><var>classList</var> = window.getClassList(<var>element</var>)</code>
      <li><code><var>classList</var>.length</code>
      <li><code><var>classList</var>.item(<var>index</var>)</code>
      <li><code><var>classList</var>.contains(<var>token</var>)</code>
      <li><code><var>classList</var>.add(<var>token</var>)</code>
      <li><code><var>classList</var>.remove(<var>token</var>)</code>
      <li><code><var>classList</var>.toggle(<var>token</var>)</code>
    </ul>
  <li><a href="https://developer.mozilla.org/en/JavaScript/Reference/Global_Objects/String">JavaScript 1.X String Extras</a> (polyfill)
    <ul>
      <li>String prototype: <code>trimLeft</code>, <code>trimRight</code>, <code>quote</code>
    </ul>
  <li><a href="http://www.ecma-international.org/publications/standards/Ecma-262.htm">ECMAScript 5</a> Object, Function, String and Date extras (polyfill)
    <ul>
      <li>Object: <code>getPrototypeOf</code>, <code>getOwnPropertyNames</code>, <code>create</code>, <code>defineProperty</code>, <code>defineProperties</code>, <code>keys</code>
      <li>Function prototype: <code>bind</code>
      <li>Array: <code>isArray</code>
      <li>Array prototype: <code>indexOf</code>, <code>lastIndexOf</code>, <code>every</code>, <code>some</code>, <code>forEach</code>, <code>map</code>, <code>filter</code>, <code>reduce</code>, <code>reduceRight</code>
      <li>String prototype: <code>trim</code>
      <li>Date: <code>now</code>
      <li>Date prototype: <code>toISOString</code>
    </ul>
</ul>

<h2 id="harmony">ECMAScript "Harmony" (polyfill)</h2>
<p>"Harmony" is the aspirational term for future iterations of ECMAScript (the standardized version of JavaScript). The standardization of ES6 is currently in progress.
<p><a href="harmony.js">script</a> - <a href="harmony.html">unit tests</a> - <a href="http://wiki.ecmascript.org/doku.php?id=harmony:proposals">wiki</a>
<ul>
  <li>Approved for inclusion in ES6:
    <ul>
      <li>Object: <code>is</code>, <code>isnt</code>
      <li>Number: <code>isFinite</code>, <code>isNaN</code>, <code>isInteger</code>, <code>toInteger</code>
      <li>String prototype: <code>repeat</code>, <code>startsWith</code>, <code>endsWith</code>, <code>contains</code>, <code>toArray</code>
      <li>Math: <code>log10</code>, <code>log2</code>, <code>log1p</code>, <code>expm1</code>, <code>cosh</code>, <code>sinh</code>, <code>tanh</code>, <code>acosh</code>, <code>asinh</code>, <code>atanh</code>, <code>hypot</code>, <code>trunc</code>, <code>sign</code>
      <li>Collections: <code>Map</code>, <code>Set</code>, <code>WeakMap</code>
    </ul>
  <li>Not yet approved:
    <ul>
      <li>Number: <code>compare</code>, <code>EPILON</code>, <code>MAX_INTEGER</code>
    </ul>
</ul>

<h2 id="url">W3C URL API (polyfill)</h2>
<p><a href="url.js">script</a> - <a href="url.html">unit tests</a> - <a href="http://dvcs.w3.org/hg/url/raw-file/tip/Overview.html">draft spec</a> - <em>See script for cross-browser quirks</em>
<ul>
<li><code>new URL(<var>url</var>, <var>base</var>)</code>
<li><code><var>value</var> = <var>url</var>.getParameter(<var>name</var>)</code>
<li><code><var>valueArray</var> = <var>url</var>.getParameterAll(<var>name</var>)</code>
<li><code><var>url</var>.appendParameter(<var>name</var>, <var>valueOrValues</var>)</code>
<li><code><var>url</var>.clearParameter(<var>name</var>)</code>
<li><code><var>nameArray</var> = <var>url</var>.parameterNames</code>
<li><code><var>url</var>.protocol</code>
<li><code><var>url</var>.host</code>
<li><code><var>url</var>.hostname</code>
<li><code><var>url</var>.port</code>
<li><code><var>url</var>.pathname</code>
<li><code><var>url</var>.search</code>
<li><code><var>url</var>.hash</code>
<li><code><var>url</var>.filename</code>
<li><code><var>url</var>.href</code>
</ul>

<h2 id="keyboard">W3C Keyboard Events (shim)</h2>
<p><a href="keyboard.js">script</a> - <a href="keyboard.html">interactive test</a> - <a href="http://www.w3.org/TR/DOM-Level-3-Events/">OLD spec</a>
<ul>
<li><code>window.identifyKey(<var>keyboardEvent</var>)</code>
<li><code><var>keyboardEvent</var>.keyName</code>
<li><code><var>keyboardEvent</var>.keyIdentifier</code>
<li><code><var>keyboardEvent</var>.keyLocation</code>
<li><code><var>keyboardEvent</var>.keyChar</code>
</ul>

<h2 id="timing">W3C Timing control for script-based animations (polyfill)</h2>
<p><a href="raf.js">script</a> - <a href="raf.html">demo page</a> - <a href="http://www.w3.org/TR/animation-timing/">spec</a>
<ul>
<li><code><var>id</var> = window.requestAnimationFrame()</code>
<li><code>window.cancelAnimationFrame(<var>id</var>)</code>
</ul>

<h2 id="storage">W3C Web Storage (polyfill)</h2>
<p><a href="storage.js">script</a> - <a href="http://dev.w3.org/html5/webstorage/">spec</a> - adapted from <a href="https://gist.github.com/350433">Remy Sharp</a>
<ul>
<li><code><var>storage</var> = window.localStorage</code>
<li><code><var>storage</var> = window.sessionStorage</code>
<li><code><var>storage</var>.clear()</code>
<li><code><var>valueString</var> = <var>storage</var>.getItem(<var>keyString</var>)</code>
<li><code><var>valueString</var> = <var>storage</var>.key(<var>index</var>)</code>
<li><code><var>storage</var>.removeItem(<var>keyString</var>)</code>
<li><code><var>storage</var>.setItem(<var>keyString</var>, <var>valueString</var>)</code>
<li><code><var>storage</var>.length</code>
</ul>

<h2 id="geo">W3C Geolocation API (Level 1) (polyfill)</h2>
<p><a href="geo.js">script</a> - <a href="geo.html">demo page</a> - <a href="http://dev.w3.org/geo/api/spec-source">spec</a> - uses <a href="http://freegeoip.net">freegeoip.net</a>
<ul>
<li><code>navigator.geolocation.getCurrentPosition(<var>successCallback</var>, <var>errorCallback</var>, <var>options</var>)</code>
<li><code><var>watchId</var> = navigator.geolocation.watchPosition(<var>successCallback</var>, <var>errorCallback</var>, <var>options</var>)</code>
<li><code>navigator.geolocation.clearWatch(<var>watchId</var>)</code>
</ul>

<h2 id="workers">W3C Workers (polyfill)</h2>
<p><a href="workers.js">script</a> - <a href="http://dev.w3.org/html5/workers/">spec</a> - <em>just for kicks; you probably don&apos;t want to use this</em>

<h2 id="cookie">Cookie API (polyfill)</h2>
<p><a href="cookie.js">script</a> - <a href="https://docs.google.com/Doc?docid=0AZpchfQ5mBrEZGQ0cDh3YzRfMTRmdHFma21kMg&hl=en&pli=1">Adam Barth&apos;s Cookie API proposal</a> - <em>abandoned</em>
<ul>
<li><code><var>cookie</var> = document.getCookie(<var>name</var>, <var>callback</var>)</code>
<li><code><var>cookieArray</var> = document.getAllCookies(<var>callback</var>)</code>
<li><code>document.setCookie(<var>cookie</var>, <var>errorCallback</var>)</code>
<li><code>document.deleteCookie(<var>name</var>, <var>errorCallback</var>)</code>
<li><code><var>cookie</var>.name</code>
<li><code><var>cookie</var>.value</code>
</ul>

<h2 id="console">Console (polyfill)</h2>
<p><a href="console.js">script</a> - <a href="console.html">unit tests</a> - <em>de facto</em> standard in modern browsers
<ul>
<li><code>console.log(<var>messageObject</var>, <var>arguments...</var>)</code>, and variations: <code>debug</code>, <code>info</code>, <code>warn</code>, <code>error</code>
<li><code>console.assert(<var>assertion</var>, <var>messageObject</var>, <var>arguments...</var>)</code>
<li><code>console.count(<var>name</var>)</code>
<li><code>console.time(<var>name</var>)</code>, <code>console.timeEnd(<var>name</var>)</code>
<li><code>console.group(<var>name</var>)</code>, <code>console.groupEnd()</code>
<li><code>console.trace()</code>
<li><code>console.clear()</code>
</ul>

<h2 id="sprintf">sprintf (other)</h2>
<p><a href="sprintf.js">script</a> - <a href="sprintf.html">unit tests</a> - <em>used for a few C-to-JavaScript porting projects</em>

<h2 id="typedarray">Khronos Typed Arrays (polyfill)</h2>
<p><a href="typedarray.js">script</a> - <a href="typedarray.html">unit tests</a> - <a href="http://www.khronos.org/registry/typedarray/specs/latest/">spec</a> - Copyright &copy; 2010 Linden Research, Inc. - MIT License. <a href="https://bitbucket.org/lindenlab/llsd/">original</a> - <em>At my previous place of employment I was doing work on binary file serialization/parsing in JavaScript and Typed Arrays were an appropriate fit, but had not yet been widely implemented.</em> - the <code>DataView</code> implementation will also polyfill an otherwise native implementation, if necessary
<ul>
<li><code>ArrayBuffer</code>
<li><code>Uint8Array</code>, <code>Int8Array</code>, <code>Uint16Array</code>, <code>Int16Array</code>, <code>Uint32Array</code>, <code>Int32Array</code>, <code>Float32Array</code>, <code>Float64Array</code>
<li><code>DataView</code>
</ul>

