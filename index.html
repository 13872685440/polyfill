<!DOCTYPE html>
<meta http-equiv="Content-Type" content="text/html;charset=utf-8">
<title>Polyfills, Shims, Helpers and More</title>
<link rel="stylesheet" href="polyfill.css">

<h1>Polyfills, Shims and More</h1>

<ul>
  <li>A <em>polyfill</em> is a collection of shims (and a catchy name).
  <li>A <em>shim</em> lets you write the same code across all browsers by implementing a new API in downlevel browsers.
  <li>A <em>helper</em> helps write cross-browser code where a true API shim/polyfill is not possible.
</ul>

<p>I use these in various pages on this site; most are by me, or I have at least tweaked them.
A more comprehensive list can be found at <a target="_blank" href="https://github.com/Modernizr/Modernizr/wiki/HTML5-Cross-browser-Polyfills">The All-In-One Entirely-Not-Alphabetical No-Bullshit Guide to HTML5 Fallbacks</a> by Paul Irish.

<ul>
  <li><a href="#polyfill">Browser Compat &amp; ECMAScript 5</a>
  <li><a href="#harmony">ECMAScript 6 / "Harmony"</a>
  <li><a href="#url">URL</a>
  <li><a href="#keyboard">Keyboard Events</a>
  <li><a href="#storage">Web Storage</a>
  <li><a href="#geo">Geolocation</a>
  <li><a href="#workers">Workers</a>
  <li><a href="#cookie">Cookies</a>
  <li><a href="#console">Console</a>
  <li><a href="#sprintf">sprintf</a>
  <li><a href="#typedarray">Typed Arrays</a>
  <li><a href="#domexception">DOMException</a>
</ul>


<h2 id="polyfill">Browser Compat &amp; ECMAScript 5 Polyfill</h2>
<p>Bundled together; nearly every page I create needs at least some of these. These will change over time, and
going forward I will only target IE8 and later.
<p><a target="_blank" href="polyfill.js">script</a> - <a target="_blank" href="polyfill.html">unit tests</a>
<ul>
  <li><a target="_blank" href="http://www.w3.org/TR/XMLHttpRequest/"><code>XMLHttpRequest</code></a> (shim for IE6-)
  <li><a target="_blank" href="http://www.w3.org/TR/selectors-api/">Selector API</a> (shim for IE7-) - adapted from <a target="_blank" href="http://ajaxian.com/archives/creating-a-queryselector-for-ie-that-runs-at-native-speed">Paul Young</a>
    <ul>
      <li><code><var>element</var> = document.querySelector(<var>selector</var>)</code>
      <li><code><var>elementArray</var> = document.querySelectorAll(<var>selector</var>)</code>
    </ul>
  <li><a target="_blank" href="http://www.w3.org/TR/DOM-Level-2-Events/">DOM Level 2 Events</a> (shim for IE8)
    <ul>
      <li><code><var>EventTarget</var>.addEventListener(<var>event</var>, <var>handler</var>)</code>
      <li><code><Var>EventTarget</var>.removeEventListener(<var>event</var>, <var>handler</var>)</code>
      <li>Where <var>EventTarget</var> is <code>window</code>, <code>document</code>, or any element.
      <li><code><var>Event</var>.target</code>
      <li><code><var>Event</var>.currentTarget</code>
      <li><code><var>Event</var>.eventPhase</code>
      <li><code><var>Event</var>.bubbles</code>
      <li><code><var>Event</var>.cancelable</code>
      <li><code><var>Event</var>.timeStamp</code>
      <li><code><var>Event</var>.defaultPrevented</code>
      <li><code><var>Event</var>.stopPropagation()</code>
      <li><code><var>Event</var>.cancelBubble()</code>
    </ul>
  <li><a target="_blank" href="http://www.w3.org/TR/DOM-Level-2-Events/">DOM Level 2 Events</a> (helper for IE7-) - adapted from <a target="_blank" href="http://www.quirksmode.org/blog/archives/2005/10/_and_the_winner_1.html">QuirksMode</a>
    <ul>
      <li><code>window.addEvent(<var>element</var>, <var>event</var>, <var>handler</var>)</code>
      <li><code>window.removeEvent(<var>element</var>, <var>event</var>, <var>handler</var>)</code>
    </ul>
  <li><a target="_blank" href="http://www.w3.org/TR/html5/dom.html">HTML5 DOM</a> (shim)
    <ul>
      <li><code>document.head</code>
      <li><code><var>elementArray</var> = document.getElementsByClassName(<var>classNames</var>)</code>
    </ul>
  <li><a target="_blank" href="http://www.w3.org/TR/html5/webappapis.html#atob">HTML5 Web Application APIs</a> (shim for IE9-)
    <ul>
      <li><code><var>encodedString</var> = window.btoa(<var>binaryString</var>)</code> - Base64 Encode
      <li><code><var>binaryString</var> = window.atob(<var>encodedString</var>)</code> - Base64 Decode
    </ul>
  <li><a target="_blank" href="http://www.w3.org/TR/html5/common-dom-interfaces.html#domtokenlist">HTML5 Infrastructure</a> -
      <a target="_blank" href="http://www.w3.org/TR/html5/elements.html#dom-classlist">classList</a>,
      <a target="_blank" href="http://www.w3.org/TR/html5/semantics.html#dom-link-rellist">relList</a> (shim)
    <ul>
      <li><code><var>tokenList</var> = window.getClassList(<var>element</var>)</code>
      <li><code><var>tokenList</var> = window.getRelList(<var>element</var>)</code>
      <li><code><var>tokenList</var> = <var>elem</var>.classList</code> - <em>not available in IE7-, so use with caution</em>
      <li><code><var>tokenList</var> = <var>elem</var>.relList</code> - <em>not available in IE7-, so use with caution</em>
      <li><code><var>tokenList</var>.length</code>
      <li><code><var>tokenList</var>.item(<var>index</var>)</code>
      <li><code><var>tokenList</var>.contains(<var>token</var>)</code>
      <li><code><var>tokenList</var>.add(<var>token</var>)</code>
      <li><code><var>tokenList</var>.remove(<var>token</var>)</code>
      <li><code><var>tokenList</var>.toggle(<var>token</var>)</code>
    </ul>

  <li><a target="_blank" href="http://www.w3.org/TR/animation-timing/">W3C Timing control for script-based animations</a> (shim) - <a target="_blank" href="raf.html">demo page</a>
    <ul>
      <li><code><var>id</var> = window.requestAnimationFrame()</code>
      <li><code>window.cancelAnimationFrame(<var>id</var>)</code>
    </ul>
  <li><a target="_blank" href="https://dvcs.w3.org/hg/webperf/raw-file/tip/specs/setImmediate/Overview.html">Efficient Script Yielding</a> (shim)
    <ul>
      <li><code><var>id</var> = setImmediate(<var>callback</var>, <var>args...</var>)</code>
      <li><code>clearImmediate(<var>id</var>)</code>
    </ul>
  <li><a target="_blank" href="https://developer.mozilla.org/en/JavaScript/Reference/Global_Objects/String">JavaScript 1.X String Extras</a> (shim)
    <ul>
      <li>String prototype: <code>trimLeft</code>, <code>trimRight</code>, <code>quote</code>
    </ul>
  <li><a target="_blank" href="http://www.ecma-international.org/publications/standards/Ecma-262.htm">ECMAScript 5</a> Object, Function, String and Date extras (shim)
    <ul>
      <li>Object: <code>getPrototypeOf</code>, <code>getOwnPropertyNames</code>, <code>create</code>, <code>defineProperty</code>, <code>defineProperties</code>, <code>keys</code>
      <li>Function prototype: <code>bind</code>
      <li>Array: <code>isArray</code>
      <li>Array prototype: <code>indexOf</code>, <code>lastIndexOf</code>, <code>every</code>, <code>some</code>, <code>forEach</code>, <code>map</code>, <code>filter</code>, <code>reduce</code>, <code>reduceRight</code>
      <li>String prototype: <code>trim</code>
      <li>Date: <code>now</code>
      <li>Date prototype: <code>toISOString</code>
    </ul>
</ul>

<h2 id="harmony">ECMAScript 6 / "Harmony" (polyfill)</h2>
<p>"Harmony" is the aspirational term for future iterations of ECMAScript (the standardized version of JavaScript). The standardization of ES6 is currently in progress. This will attempt to track the evolving spec, so may change at any time.
<p><a target="_blank" href="harmony.js">script</a> - <a target="_blank" href="harmony.html">unit tests</a> - <a target="_blank" href="http://wiki.ecmascript.org/doku.php?id=harmony:proposals">wiki</a>
<ul>
  <li>In the <a target="_blank" href="http://wiki.ecmascript.org/doku.php?id=harmony:specification_drafts">ES6 Drafts</a>:
    <ul>
      <li>Object:
        <code>assign()</code>,
        <code>is()</code> (as function, not operator),
        <code>isnt()</code> (ditto),
        <!-- <code>isObject()</code> -->
      <li>Number:
        <code>EPILON</code>,
        <code>MAX_INTEGER</code>,
        <code>parseInt()</code>,
        <code>parseFloat()</code>,
        <code>isFinite()</code>,
        <code>isNaN()</code>,
        <code>isInteger()</code>,
        <code>toInt()</code>
      <li>Number prototype:
        <code>clz()</code>,
      <li>String:
        <code>fromCodePoint()</code>
      <li>String.prototype:
        <code>codePointAt()</code>
        <code>repeat()</code>,
        <code>startsWith()</code>,
        <code>endsWith()</code>,
        <code>contains()</code>,
        <code>@@iterator()</code>
      <li>Math:
        <code>log10()</code>,
        <code>log2()</code>,
        <code>log1p()</code>,
        <code>expm1()</code>,
        <code>cosh()</code>,
        <code>sinh()</code>,
        <code>tanh()</code>,
        <code>acosh()</code>,
        <code>asinh()</code>,
        <code>atanh()</code>,
        <code>hypot()</code>,
        <code>trunc()</code>,
        <code>sign()</code>,
        <code>cbrt()</code>
      <li>Array:
        <code>of()</code>,
        <code>from()</code>
      <li>Array prototype:
        <code>items()</code>,
        <code>keys()</code>,
        <code>values()</code>,
        <code>@@iterator()</code>
      <li>Map:
        <code>clear()</code>,
        <code>delete()</code>,
        <code>forEach()</code>,
        <code>get()</code>,
        <code>has()</code>,
        <code>items()</code>,
        <code>keys()</code>,
        <code>set()</code>,
        <code>size</code>,
        <code>values()</code>,
        <code>@@iterator()</code>
      <li>Set:
        <code>add()</code>,
        <code>clear()</code>,
        <code>delete()</code>,
        <code>forEach()</code>,
        <code>has()</code>,
        <code>size</code>,
        <code>values()</code>,
        <code>@@iterator()</code>
      <li>WeakMap (intrusive; modifies valueOf property of key):
        <code>clear()</code>,
        <code>delete()</code>,
        <code>get()</code>,
        <code>has()</code>,
        <code>set()</code>
    </ul>
  <li>Not yet approved:
    <ul>
      <li>Number:
        <code>compare()</code>
      <li>Array prototype:
        <code>pushAll()</code>,
        <code>contains()</code> <a href="https://mail.mozilla.org/pipermail/es-discuss/2011-December/019099.html">[ref]</a>
      <li>String prototype:
        <code>@@iterator()</code> <a href="http://norbertlindenberg.com/2012/05/ecmascript-supplementary-characters/index.html">[ref]</a>
      <li>WeakSet (intrusive; modifies valueOf property of key):
        <code>add()</code>,
        <code>clear()</code>,
        <code>delete()</code>,
        <code>has()</code>,
      <li>Dict:
        <code>keys(<var>dict</var>)</code>,
        <code>values(<var>dict</var>)</code>
        <code>entries(<var>dict</var>)</code>
        <ul>
          <li><code>new Dict</code> is shortcut for <code>Object.create(null)</code>.
        </ul>
      <li>Symbol
        <ul>
          <li>No security, just creates an object with a unique string representation.
        </ul>
    </ul>
</ul>

<h2 id="url">WHATWG URL API (shim)</h2>
<p><a target="_blank" href="url.js">script</a> - <a target="_blank" href="url.html">unit tests</a> - <a target="_blank" href="http://url.spec.whatwg.org">draft spec</a> - <em>See script for cross-browser quirks</em>
<ul>
<li><code><var>url</var> = new URL(<var>url</var>, <var>base</var>)</code>
<li><code><var>value</var> = <var>url</var>.getParameter(<var>name</var>)</code>
<li><code><var>valueArray</var> = <var>url</var>.getParameterAll(<var>name</var>)</code>
<li><code><var>url</var>.appendParameter(<var>name</var>, <var>valueOrValues</var>)</code>
<li><code><var>url</var>.clearParameter(<var>name</var>)</code>
<li><code><var>nameArray</var> = <var>url</var>.parameterNames</code>
<li><code><var>url</var>.protocol</code>
<li><code><var>url</var>.host</code>
<li><code><var>url</var>.hostname</code>
<li><code><var>url</var>.port</code>
<li><code><var>url</var>.pathname</code>
<li><code><var>url</var>.search</code>
<li><code><var>url</var>.hash</code>
<li><code><var>url</var>.filename</code>
<li><code><var>url</var>.href</code>
</ul>

<h2 id="keyboard">W3C Keyboard Events (helper)</h2>
<p><a target="_blank" href="keyboard.js">script</a> - <a target="_blank" href="keyboard.html">interactive test</a> - <a target="_blank" href="http://www.w3.org/TR/DOM-Level-3-Events/">OLD spec</a>
<ul>
<li><code>window.identifyKey(<var>keyboardEvent</var>)</code>
<li><code><var>keyboardEvent</var>.keyName</code>
<li><code><var>keyboardEvent</var>.keyIdentifier</code>
<li><code><var>keyboardEvent</var>.keyLocation</code>
<li><code><var>keyboardEvent</var>.keyChar</code>
</ul>

<h2 id="storage">W3C Web Storage (shim)</h2>
<p><a target="_blank" href="storage.js">script</a> - <a target="_blank" href="http://dev.w3.org/html5/webstorage/">spec</a> - adapted from <a target="_blank" href="https://gist.github.com/350433">Remy Sharp</a>
<ul>
<li><code><var>storage</var> = window.localStorage</code>
<li><code><var>storage</var> = window.sessionStorage</code>
<li><code><var>storage</var>.clear()</code>
<li><code><var>valueString</var> = <var>storage</var>.getItem(<var>keyString</var>)</code>
<li><code><var>valueString</var> = <var>storage</var>.key(<var>index</var>)</code>
<li><code><var>storage</var>.removeItem(<var>keyString</var>)</code>
<li><code><var>storage</var>.setItem(<var>keyString</var>, <var>valueString</var>)</code>
<li><code><var>storage</var>.length</code>
</ul>

<h2 id="geo">W3C Geolocation API (Level 1) (shim)</h2>
<p><a target="_blank" href="geo.js">script</a> - <a target="_blank" href="geo.html">demo page</a> - <a target="_blank" href="http://dev.w3.org/geo/api/spec-source">spec</a> - uses <a target="_blank" href="http://freegeoip.net">freegeoip.net</a>
<ul>
<li><code>navigator.geolocation.getCurrentPosition(<var>successCallback</var>, <var>errorCallback</var>, <var>options</var>)</code>
<li><code><var>watchId</var> = navigator.geolocation.watchPosition(<var>successCallback</var>, <var>errorCallback</var>, <var>options</var>)</code>
<li><code>navigator.geolocation.clearWatch(<var>watchId</var>)</code>
</ul>

<h2 id="workers">W3C Workers (shim)</h2>
<p><a target="_blank" href="workers.js">script</a> - <a target="_blank" href="http://dev.w3.org/html5/workers/">spec</a> - <em>just for kicks; you probably don't want to use this</em>

<h2 id="cookie">Cookie API (shim)</h2>
<p><a target="_blank" href="cookie.js">script</a> - <a target="_blank" href="https://docs.google.com/Doc?docid=0AZpchfQ5mBrEZGQ0cDh3YzRfMTRmdHFma21kMg&amp;hl=en&amp;pli=1">Adam Barth's Cookie API proposal</a> - <em>abandoned</em>
<ul>
<li><code><var>cookie</var> = document.getCookie(<var>name</var>, <var>callback</var>)</code>
<li><code><var>cookieArray</var> = document.getAllCookies(<var>callback</var>)</code>
<li><code>document.setCookie(<var>cookie</var>, <var>errorCallback</var>)</code>
<li><code>document.deleteCookie(<var>name</var>, <var>errorCallback</var>)</code>
<li><code><var>cookie</var>.name</code>
<li><code><var>cookie</var>.value</code>
</ul>

<h2 id="console">Console (shim)</h2>
<p><a target="_blank" href="console.js">script</a> - <a target="_blank" href="console.html">unit tests</a> - <em>de facto</em> standard in modern browsers
<ul>
<li><code>console.log(<var>messageObject</var>, <var>arguments...</var>)</code>, and variations: <code>debug</code>, <code>info</code>, <code>warn</code>, <code>error</code>
<li><code>console.assert(<var>assertion</var>, <var>messageObject</var>, <var>arguments...</var>)</code>
<li><code>console.count(<var>name</var>)</code>
<li><code>console.time(<var>name</var>)</code>, <code>console.timeEnd(<var>name</var>)</code>
<li><code>console.group(<var>name</var>)</code>, <code>console.groupEnd()</code>
<li><code>console.trace()</code>
<li><code>console.clear()</code>
</ul>

<h2 id="sprintf">sprintf (other)</h2>
<p><a target="_blank" href="sprintf.js">script</a> - <a target="_blank" href="sprintf.html">unit tests</a> - <em>used for a few C-to-JavaScript porting projects</em>

<h2 id="typedarray">Khronos Typed Arrays (polyfill)</h2>
<p><a target="_blank" href="typedarray.js">script</a> - <a target="_blank" href="typedarray.html">unit tests</a> - <a target="_blank" href="http://www.khronos.org/registry/typedarray/specs/latest/">spec</a> - Copyright &copy; 2010 Linden Research, Inc. - MIT License. <a target="_blank" href="https://bitbucket.org/lindenlab/llsd/">original</a> - <em>At my previous place of employment I was doing work on binary file serialization/parsing in JavaScript and Typed Arrays were an appropriate fit, but had not yet been widely implemented.</em> - the <code>DataView</code> implementation will also polyfill an otherwise native implementation, if necessary.
<ul>
<li><code>ArrayBuffer</code>
<li><code>Uint8Array</code>, <code>Int8Array</code>, <code>Uint16Array</code>, <code>Int16Array</code>, <code>Uint32Array</code>, <code>Int32Array</code>, <code>Float32Array</code>, <code>Float64Array</code>
<li><code>DataView</code>
</ul>

<h2 id="domexception">DOMException (helper)</h2>
<p><a target="_blank" href="domexception.js">script</a> - <a target="_blank" href="domexception.html">demo page</a> - creates a native DOMException of the specified type if possible, otherwise a similar looking object. Useful when implementing other polyfills.
<ul>
<li><code><var>exception</var> = DOMException.create(<var>code</var>)</code>
</ul>

<script type="text/javascript">

  var _gaq = _gaq || [];
  _gaq.push(['_setAccount', 'UA-18610679-3']);
  _gaq.push(['_trackPageview']);

  (function() {
    var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
    ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
    var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
  })();

</script>
